#!/usr/bin/env bash
# Scan a directory for skill .md files
# Usage: scan-skills <dir>
# Output: path|skill|name (one per line)

set -e

dir="${1:?Usage: scan-skills <dir>}"
[ -d "$dir" ] || exit 0

while IFS= read -r f; do
  base=$(basename "$f" .md)
  if [[ "$base" == "SKILL" || "$base" == "skill" ]]; then
    name=$(basename "$(dirname "$f")")
  else
    name="$base"
  fi
  echo "$f|skill|$name"
done < <(find -L "$dir" -name "*.md" -type f 2>/dev/null)
