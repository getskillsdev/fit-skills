#!/usr/bin/env bash
# List all skills and commands for a source
# Usage: list-skills <source>
#   source: global | plugins | project
#
# Output: path|type|name (one per line)
#   type: skill | command

set -e

source="${1:?Usage: list-skills <global|plugins|project>}"
bin_dir="$(cd "$(dirname "$0")" && pwd)"

# Map source names to all/* scripts
case "$source" in
  global)
    script="$bin_dir/all/user-items"
    ;;
  plugins)
    script="$bin_dir/all/plugin-items"
    ;;
  project)
    script="$bin_dir/all/project-items"
    ;;
  *)
    echo "Unknown source: $source" >&2
    echo "Usage: list-skills <global|plugins|project>" >&2
    exit 1
    ;;
esac

# Convert JSON to path|type|name format
"$script" | jq -r '.[] | "\(.path)|\(.type)|\(.name)"'
