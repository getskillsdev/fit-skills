#!/usr/bin/env bash
# List all skills and commands from global ~/.claude/
# Output: path|type|name (one per line)

set -e

# Skills: find all .md files in ~/.claude/skills/
if [ -d "$HOME/.claude/skills" ]; then
  while IFS= read -r f; do
    # Skip bin/ directories
    [[ "$f" == */bin/* ]] && continue

    # Extract name from path
    base=$(basename "$f" .md)

    # Check if it's a SKILL.md or skill.md in a subdir

    if [[ "$base" == "SKILL" || "$base" == "skill" ]]; then
      name=$(basename "$(dirname "$f")")
    else
      # Flat .md file - use filename as name
      name="$base"
    fi
    echo "$f|skill|$name"
  done < <(find -L "$HOME/.claude/skills" -name "*.md" -type f 2>/dev/null)
fi

# Commands
bin_dir="$(cd "$(dirname "$0")/.." && pwd)"
"$bin_dir/scan-commands" "$HOME/.claude/commands"
